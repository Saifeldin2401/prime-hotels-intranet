<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PRIME Hotels Intranet - System Architecture | Ø¨Ù†ÙŠØ© Ø§Ù„Ù†Ø¸Ø§Ù…</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        @media print {
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }

            .page-break {
                page-break-before: always;
            }

            .no-print {
                display: none;
            }
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Noto Sans Arabic', sans-serif;
            line-height: 1.7;
            color: #1a1a2e;
            max-width: 1100px;
            margin: 0 auto;
            padding: 40px 20px;
            background: #fff;
        }

        h1 {
            color: #1a1a2e;
            border-bottom: 3px solid #c9a962;
            padding-bottom: 15px;
            font-size: 2.2em;
        }

        h2 {
            color: #2d2d44;
            border-bottom: 2px solid #e5e5e5;
            padding-bottom: 10px;
            margin-top: 40px;
        }

        h3 {
            color: #444;
            margin-top: 25px;
        }

        .ar {
            direction: rtl;
            text-align: right;
            font-family: 'Noto Sans Arabic', 'Segoe UI', Tahoma, sans-serif;
            color: #555;
            background: #f9f9f9;
            padding: 10px 15px;
            border-radius: 6px;
            margin: 10px 0 20px 0;
            border-right: 4px solid #c9a962;
        }

        blockquote {
            background: #f8f9fa;
            border-left: 4px solid #c9a962;
            padding: 15px 20px;
            margin: 20px 0;
            font-style: italic;
        }

        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
        }

        pre {
            background: #1e1e2e;
            color: #cdd6f4;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 0.85em;
        }

        pre code {
            background: none;
            padding: 0;
            color: inherit;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 0.9em;
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }

        th {
            background: #2d2d44;
            color: white;
            font-weight: 600;
        }

        tr:nth-child(even) {
            background: #f8f9fa;
        }

        .mermaid {
            background: #fafafa;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
        }

        hr {
            border: none;
            border-top: 2px solid #e5e5e5;
            margin: 40px 0;
        }

        .print-button {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #c9a962;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        .print-button:hover {
            background: #b8954f;
        }

        .header-logo {
            text-align: center;
            margin-bottom: 30px;
        }

        .header-logo h1 {
            font-size: 2.5em;
            border: none;
            margin-bottom: 5px;
        }

        .header-logo .subtitle {
            color: #666;
            font-size: 1.2em;
        }

        .bilingual-header {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            flex-wrap: wrap;
        }

        .bilingual-header .ar-title {
            font-family: 'Noto Sans Arabic', 'Segoe UI', sans-serif;
            color: #666;
            font-size: 0.65em;
            direction: rtl;
        }
    </style>
</head>

<body>
    <button class="print-button no-print" onclick="window.print()">ğŸ“„ Save as PDF | Ø­ÙØ¸ ÙƒÙ€ PDF</button>

    <div class="header-logo">
        <h1>ğŸ¨ PRIME Hotels Intranet</h1>
        <p class="subtitle">System Architecture Documentation</p>
        <p class="subtitle" style="font-family: 'Noto Sans Arabic', sans-serif; direction: rtl;">ØªÙˆØ«ÙŠÙ‚ Ø¨Ù†ÙŠØ© Ø§Ù„Ù†Ø¸Ø§Ù… -
            ÙÙ†Ø§Ø¯Ù‚ Ø¨Ø±Ø§ÙŠÙ…</p>
    </div>

    <blockquote>
        <strong>Deep Analysis Document</strong> - Based on examination of 96 database migrations, core contexts, hooks,
        and services.<br>
        <span style="direction: rtl; display: block; margin-top: 10px;"><strong>ÙˆØ«ÙŠÙ‚Ø© Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø¹Ù…Ù‚</strong> - Ø¨Ù†Ø§Ø¡Ù‹
            Ø¹Ù„Ù‰ ÙØ­Øµ 96 ØªØ±Ø­ÙŠÙ„ Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ø³ÙŠØ§Ù‚Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ÙˆØ§Ù„Ø®Ø·Ø§ÙØ§Øª ÙˆØ§Ù„Ø®Ø¯Ù…Ø§Øª.</span>
    </blockquote>

    <hr>

    <h2 class="bilingual-header">ğŸ—„ï¸ Database Entity Relationship Diagram <span class="ar-title">Ù…Ø®Ø·Ø· Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„ÙƒÙŠØ§Ù†Ø§Øª ÙÙŠ
            Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</span></h2>

    <div class="mermaid">
        erDiagram
        auth_users ||--|| profiles : "extends"
        profiles ||--o{ user_roles : "has"
        profiles ||--o{ user_properties : "assigned to"
        profiles ||--o{ user_departments : "works in"
        profiles ||--o| profiles : "reports to"
        properties ||--o{ departments : "contains"
        properties ||--o{ user_properties : "has members"
        departments ||--o{ user_departments : "has members"
        training_modules ||--o{ training_assignments : "assigned via"
        training_modules ||--o{ training_progress : "tracks"
        training_assignments }o--o| profiles : "to user"
        training_assignments }o--o| departments : "to dept"
        training_assignments }o--o| properties : "to property"
        requests ||--o{ request_steps : "has"
        requests ||--o{ request_comments : "has"
        requests }o--|| profiles : "requester"
        leave_requests }o--|| profiles : "requester"
        leave_requests }o--o| properties : "scoped to"
        maintenance_tickets }o--|| profiles : "reported by"
        maintenance_tickets }o--o| properties : "location"
        documents }o--|| profiles : "created by"
        documents ||--o{ document_acknowledgments : "requires"
        promotions }o--|| profiles : "employee"
        transfers }o--|| profiles : "employee"
        onboarding_templates ||--o{ onboarding_process : "triggers"
        onboarding_process ||--o{ onboarding_tasks : "generates"

        profiles {
        uuid id PK
        text email
        text full_name
        text job_title
        uuid reporting_to FK
        }
        properties {
        uuid id PK
        text name
        text address
        }
        departments {
        uuid id PK
        uuid property_id FK
        text name
        }
        user_roles {
        uuid id PK
        uuid user_id FK
        app_role role
        }
    </div>

    <hr>

    <h2 class="bilingual-header">ğŸ‘¥ Role Hierarchy <span class="ar-title">Ø§Ù„ØªØ³Ù„Ø³Ù„ Ø§Ù„Ù‡Ø±Ù…ÙŠ Ù„Ù„Ø£Ø¯ÙˆØ§Ø±</span></h2>

    <div class="ar">
        ÙŠØ³ØªØ®Ø¯Ù… Ø§Ù„Ù†Ø¸Ø§Ù… 6 Ø£Ø¯ÙˆØ§Ø± Ù…Ø±ØªØ¨Ø© Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰ ØµÙ„Ø§Ø­ÙŠØ© Ø¥Ù„Ù‰ Ø§Ù„Ø£Ø¯Ù†Ù‰:
        <br>â€¢ <strong>Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ø¥Ù‚Ù„ÙŠÙ…ÙŠ</strong> (regional_admin) - Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 1: ÙˆØµÙˆÙ„ ÙƒØ§Ù…Ù„ Ù„Ù„Ù†Ø¸Ø§Ù…
        <br>â€¢ <strong>Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ© Ø§Ù„Ø¥Ù‚Ù„ÙŠÙ…ÙŠØ©</strong> (regional_hr) - Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 2: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ© Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰
        Ø§Ù„Ø³Ù„Ø³Ù„Ø©
        <br>â€¢ <strong>Ù…Ø¯ÙŠØ± Ø§Ù„ÙÙ†Ø¯Ù‚</strong> (property_manager) - Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 3: Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ÙÙ†Ø¯Ù‚
        <br>â€¢ <strong>Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ© Ù„Ù„ÙÙ†Ø¯Ù‚</strong> (property_hr) - Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 4: Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ© Ù„Ù„ÙÙ†Ø¯Ù‚
        <br>â€¢ <strong>Ø±Ø¦ÙŠØ³ Ø§Ù„Ù‚Ø³Ù…</strong> (department_head) - Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 5: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‚Ø³Ù…
        <br>â€¢ <strong>Ø§Ù„Ù…ÙˆØ¸Ù</strong> (staff) - Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 6: Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ÙØ±Ø¯ÙŠØ©
    </div>

    <div class="mermaid">
        flowchart TD
        subgraph Regional["ğŸŒ Regional Scope - All Properties | Ø§Ù„Ù†Ø·Ø§Ù‚ Ø§Ù„Ø¥Ù‚Ù„ÙŠÙ…ÙŠ"]
        RA["ğŸ”´ regional_admin - Level 1 | Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ø¥Ù‚Ù„ÙŠÙ…ÙŠ"]
        RH["ğŸŸ  regional_hr - Level 2 | Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ© Ø§Ù„Ø¥Ù‚Ù„ÙŠÙ…ÙŠØ©"]
        end
        subgraph Property["ğŸ¨ Property Scope | Ù†Ø·Ø§Ù‚ Ø§Ù„ÙÙ†Ø¯Ù‚"]
        PM["ğŸŸ¡ property_manager - Level 3 | Ù…Ø¯ÙŠØ± Ø§Ù„ÙÙ†Ø¯Ù‚"]
        PH["ğŸŸ¢ property_hr - Level 4 | Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø´Ø±ÙŠØ© Ø§Ù„ÙÙ†Ø¯Ù‚"]
        end
        subgraph Department["ğŸ“ Department Scope | Ù†Ø·Ø§Ù‚ Ø§Ù„Ù‚Ø³Ù…"]
        DH["ğŸ”µ department_head - Level 5 | Ø±Ø¦ÙŠØ³ Ø§Ù„Ù‚Ø³Ù…"]
        end
        subgraph Staff["ğŸ‘¤ Self Scope | Ø§Ù„Ù†Ø·Ø§Ù‚ Ø§Ù„Ø´Ø®ØµÙŠ"]
        ST["âšª staff - Level 6 | Ø§Ù„Ù…ÙˆØ¸Ù"]
        end
        RA --> RH --> PM --> PH --> DH --> ST
    </div>

    <h3>Role Capabilities Matrix | Ù…ØµÙÙˆÙØ© ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø£Ø¯ÙˆØ§Ø±</h3>

    <table>
        <tr>
            <th>Capability | Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©</th>
            <th>Regional Admin<br>Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ø¥Ù‚Ù„ÙŠÙ…ÙŠ</th>
            <th>Regional HR<br>Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø´Ø±ÙŠØ© Ø¥Ù‚Ù„ÙŠÙ…ÙŠØ©</th>
            <th>Property Manager<br>Ù…Ø¯ÙŠØ± Ø§Ù„ÙÙ†Ø¯Ù‚</th>
            <th>Property HR<br>Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø´Ø±ÙŠØ© Ø§Ù„ÙÙ†Ø¯Ù‚</th>
            <th>Dept Head<br>Ø±Ø¦ÙŠØ³ Ø§Ù„Ù‚Ø³Ù…</th>
            <th>Staff<br>Ø§Ù„Ù…ÙˆØ¸Ù</th>
        </tr>
        <tr>
            <td><strong>View All Properties</strong><br>Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙÙ†Ø§Ø¯Ù‚</td>
            <td>âœ…</td>
            <td>âœ…</td>
            <td>âŒ</td>
            <td>âŒ</td>
            <td>âŒ</td>
            <td>âŒ</td>
        </tr>
        <tr>
            <td><strong>Manage All Users</strong><br>Ø¥Ø¯Ø§Ø±Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</td>
            <td>âœ…</td>
            <td>âœ…</td>
            <td>âŒ</td>
            <td>âŒ</td>
            <td>âŒ</td>
            <td>âŒ</td>
        </tr>
        <tr>
            <td><strong>Approve Leave</strong><br>Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª</td>
            <td>âœ…</td>
            <td>âœ…</td>
            <td>âœ…</td>
            <td>âœ…</td>
            <td>âŒ</td>
            <td>âŒ</td>
        </tr>
        <tr>
            <td><strong>Approve Promotions</strong><br>Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„ØªØ±Ù‚ÙŠØ§Øª</td>
            <td>âœ…</td>
            <td>âœ…</td>
            <td>âŒ</td>
            <td>âŒ</td>
            <td>âŒ</td>
            <td>âŒ</td>
        </tr>
        <tr>
            <td><strong>Create Training</strong><br>Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªØ¯Ø±ÙŠØ¨</td>
            <td>âœ…</td>
            <td>âœ…</td>
            <td>âœ…</td>
            <td>âœ…</td>
            <td>âœ…</td>
            <td>âŒ</td>
        </tr>
        <tr>
            <td><strong>Assign Tasks</strong><br>ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ù‡Ø§Ù…</td>
            <td>âœ…</td>
            <td>âœ…</td>
            <td>âœ…</td>
            <td>âœ…</td>
            <td>âœ…</td>
            <td>âŒ</td>
        </tr>
        <tr>
            <td><strong>Submit Requests</strong><br>ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø·Ù„Ø¨Ø§Øª</td>
            <td>âœ…</td>
            <td>âœ…</td>
            <td>âœ…</td>
            <td>âœ…</td>
            <td>âœ…</td>
            <td>âœ…</td>
        </tr>
    </table>

    <hr>

    <h2 class="bilingual-header">ğŸ” Authentication & Authorization Flow <span class="ar-title">ØªØ¯ÙÙ‚ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
            ÙˆØ§Ù„ØªÙÙˆÙŠØ¶</span></h2>

    <div class="ar">
        Ø¹Ù†Ø¯Ù…Ø§ ÙŠØ³Ø¬Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¯Ø®ÙˆÙ„ØŒ ÙŠÙ‚ÙˆÙ… Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ù€:
        <br>1. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø¹Ø¨Ø± Supabase Auth
        <br>2. ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ Ù…Ù† Ø¬Ø¯ÙˆÙ„ profiles
        <br>3. ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø¯ÙˆØ§Ø± Ù…Ù† Ø¬Ø¯ÙˆÙ„ user_roles
        <br>4. ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙ†Ø§Ø¯Ù‚ Ø§Ù„Ù…Ø¹ÙŠÙ†Ø© Ù…Ù† user_properties
        <br>5. ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ù…Ø¹ÙŠÙ†Ø© Ù…Ù† user_departments
        <br>6. Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ (primaryRole) Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø£Ø¹Ù„Ù‰ ØµÙ„Ø§Ø­ÙŠØ©
    </div>

    <div class="mermaid">
        sequenceDiagram
        participant U as User | Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        participant A as Supabase Auth
        participant AC as AuthContext
        participant PC as PropertyContext
        participant DB as Database | Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        U->>A: Login | ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        A->>AC: Session + User ID
        par Load User Data | ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        AC->>DB: SELECT profiles
        AC->>DB: SELECT user_roles
        AC->>DB: SELECT user_properties
        AC->>DB: SELECT user_departments
        end
        AC->>AC: Compute primaryRole | Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ
        AC->>PC: Provide roles + user
        alt Regional Role | Ø¯ÙˆØ± Ø¥Ù‚Ù„ÙŠÙ…ÙŠ
        PC->>DB: SELECT ALL properties
        else Property Role | Ø¯ÙˆØ± ÙÙ†Ø¯Ù‚
        PC->>DB: SELECT assigned properties
        end
        PC->>U: Current Property Context
    </div>

    <hr class="page-break">

    <h2 class="bilingual-header">ğŸ“‹ Generic Request Workflow System <span class="ar-title">Ù†Ø¸Ø§Ù… Ø³ÙŠØ± Ø¹Ù…Ù„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
            Ø§Ù„Ø¹Ø§Ù…</span></h2>

    <div class="ar">
        ÙŠØ³ØªØ®Ø¯Ù… Ø§Ù„Ù†Ø¸Ø§Ù… Ø¬Ø¯ÙˆÙ„ <code>requests</code> Ù…ÙˆØ­Ø¯ Ù„Ø¬Ù…ÙŠØ¹ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©:
        <br>â€¢ <strong>Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©</strong> (leave_requests)
        <br>â€¢ <strong>Ø§Ù„ØªØ±Ù‚ÙŠØ§Øª</strong> (promotions)
        <br>â€¢ <strong>Ø§Ù„ØªÙ†Ù‚Ù„Ø§Øª</strong> (transfers)
        <br>â€¢ <strong>Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª</strong> (documents)
    </div>

    <div class="mermaid">
        stateDiagram-v2
        [*] --> draft: Create | Ø¥Ù†Ø´Ø§Ø¡
        draft --> pending_supervisor: Submit | ØªÙ‚Ø¯ÙŠÙ…
        pending_supervisor --> pending_hr: Approve | Ù…ÙˆØ§ÙÙ‚Ø©
        pending_supervisor --> returned: Return | Ø¥Ø±Ø¬Ø§Ø¹
        pending_supervisor --> rejected: Reject | Ø±ÙØ¶
        pending_hr --> approved: HR Approves | Ù…ÙˆØ§ÙÙ‚Ø© HR
        pending_hr --> returned: Return | Ø¥Ø±Ø¬Ø§Ø¹
        pending_hr --> rejected: Reject | Ø±ÙØ¶
        returned --> pending_supervisor: Resubmit | Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…
        approved --> closed: Auto | ØªÙ„Ù‚Ø§Ø¦ÙŠ
        rejected --> [*]
        closed --> [*]
    </div>

    <h3>Entities Using Request Workflow | Ø§Ù„ÙƒÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙŠ ØªØ³ØªØ®Ø¯Ù… Ø³ÙŠØ± Ø¹Ù…Ù„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h3>

    <table>
        <tr>
            <th>Entity Type | Ù†ÙˆØ¹ Ø§Ù„ÙƒÙŠØ§Ù†</th>
            <th>Table | Ø§Ù„Ø¬Ø¯ÙˆÙ„</th>
            <th>Request Integration | Ø±Ø¨Ø· Ø§Ù„Ø·Ù„Ø¨</th>
        </tr>
        <tr>
            <td>Leave Request | Ø·Ù„Ø¨ Ø¥Ø¬Ø§Ø²Ø©</td>
            <td>leave_requests</td>
            <td>requests.entity_type = 'leave_request'</td>
        </tr>
        <tr>
            <td>Promotion | ØªØ±Ù‚ÙŠØ©</td>
            <td>promotions</td>
            <td>requests.entity_type = 'promotion'</td>
        </tr>
        <tr>
            <td>Transfer | Ù†Ù‚Ù„</td>
            <td>transfers</td>
            <td>requests.entity_type = 'transfer'</td>
        </tr>
        <tr>
            <td>Document | Ù…Ø³ØªÙ†Ø¯</td>
            <td>documents</td>
            <td>Uses document_approvals table</td>
        </tr>
    </table>

    <hr>

    <h2 class="bilingual-header">ğŸ¯ Training Assignment Targeting <span class="ar-title">Ø§Ø³ØªÙ‡Ø¯Ø§Ù ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªØ¯Ø±ÙŠØ¨</span>
    </h2>

    <div class="ar">
        ÙŠÙ…ÙƒÙ† ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ù„Ø£Ù†ÙˆØ§Ø¹ Ù…Ø®ØªÙ„ÙØ© Ù…Ù† Ø§Ù„Ø£Ù‡Ø¯Ø§Ù:
        <br>â€¢ <strong>Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø­Ø¯Ø¯</strong> - assigned_to_user_id
        <br>â€¢ <strong>Ù‚Ø³Ù… ÙƒØ§Ù…Ù„</strong> - assigned_to_department_id
        <br>â€¢ <strong>ÙÙ†Ø¯Ù‚ ÙƒØ§Ù…Ù„</strong> - assigned_to_property_id
        <br>â€¢ <strong>Ø§Ù„Ø¬Ù…ÙŠØ¹</strong> - assigned_to_all = true
    </div>

    <div class="mermaid">
        flowchart LR
        TA[training_assignments<br>ØªØ¹ÙŠÙŠÙ†Ø§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨] --> U["ğŸ‘¤ User | Ù…Ø³ØªØ®Ø¯Ù…"]
        TA --> D["ğŸ“ Department | Ù‚Ø³Ù…"]
        TA --> P["ğŸ¨ Property | ÙÙ†Ø¯Ù‚"]
        TA --> A["ğŸŒ Everyone | Ø§Ù„Ø¬Ù…ÙŠØ¹"]
    </div>

    <hr>

    <h2 class="bilingual-header">ğŸ“„ Document Visibility System <span class="ar-title">Ù†Ø¸Ø§Ù… Ø±Ø¤ÙŠØ© Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª</span></h2>

    <div class="ar">
        Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ù„Ù‡Ø§ 4 Ù…Ø³ØªÙˆÙŠØ§Øª Ø±Ø¤ÙŠØ©:
        <br>â€¢ <strong>all_properties</strong> - Ù…Ø±Ø¦ÙŠ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙÙ†Ø§Ø¯Ù‚ Ø¹Ù†Ø¯ Ø§Ù„Ù†Ø´Ø±
        <br>â€¢ <strong>property</strong> - Ù…Ø±Ø¦ÙŠ ÙÙ‚Ø· Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙÙŠ ÙÙ†Ø¯Ù‚ Ù…Ø­Ø¯Ø¯
        <br>â€¢ <strong>department</strong> - Ù…Ø±Ø¦ÙŠ ÙÙ‚Ø· Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ù‚Ø³Ù… Ù…Ø­Ø¯Ø¯
        <br>â€¢ <strong>role</strong> - Ù…Ø±Ø¦ÙŠ ÙÙ‚Ø· Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø¨Ø¯ÙˆØ± Ù…Ø­Ø¯Ø¯
    </div>

    <div class="mermaid">
        flowchart TD
        D[Document | Ù…Ø³ØªÙ†Ø¯] --> V{visibility | Ø§Ù„Ø±Ø¤ÙŠØ©}
        V -->|all_properties| AP["All users when PUBLISHED | Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø¹Ù†Ø¯ Ø§Ù„Ù†Ø´Ø±"]
        V -->|property| PP["Users with property access | Ù…Ø³ØªØ®Ø¯Ù…Ùˆ Ø§Ù„ÙÙ†Ø¯Ù‚"]
        V -->|department| DP["Users in same department | Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ù‚Ø³Ù…"]
        V -->|role| RP["Users with matching role | Ø­Ø³Ø¨ Ø§Ù„Ø¯ÙˆØ±"]
        D --> S{status | Ø§Ù„Ø­Ø§Ù„Ø©}
        S -->|DRAFT| DR["Only creator + regional | Ø§Ù„Ù…Ù†Ø´Ø¦ + Ø§Ù„Ø¥Ù‚Ù„ÙŠÙ…ÙŠÙŠÙ†"]
        S -->|PUBLISHED| PU["Based on visibility rules | Ø­Ø³Ø¨ Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø±Ø¤ÙŠØ©"]
    </div>

    <hr>

    <h2 class="bilingual-header">ğŸš€ Onboarding Auto-Trigger <span class="ar-title">Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„ØªÙ‡ÙŠØ¦Ø©</span></h2>

    <div class="ar">
        Ø¹Ù†Ø¯Ù…Ø§ ÙŠØªÙ… ØªØ¹ÙŠÙŠÙ† Ù…ÙˆØ¸Ù Ø¬Ø¯ÙŠØ¯ Ø¥Ù„Ù‰ Ù‚Ø³Ù…ØŒ ÙŠØ¨Ø¯Ø£ Ø§Ù„Ù†Ø¸Ø§Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªÙ‡ÙŠØ¦Ø©:
        <br>1. Ø¥Ø¯Ø±Ø§Ø¬ ÙÙŠ Ø¬Ø¯ÙˆÙ„ user_departments ÙŠÙØ¹Ù„ Ø§Ù„Ù…Ø´ØºÙ„
        <br>2. Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù‚Ø§Ù„Ø¨ ØªÙ‡ÙŠØ¦Ø© Ù…Ø·Ø§Ø¨Ù‚ Ù„Ù„Ù‚Ø³Ù… Ø£Ùˆ Ø§Ù„Ø¯ÙˆØ±
        <br>3. Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù…Ù„ÙŠØ© ØªÙ‡ÙŠØ¦Ø© (onboarding_process)
        <br>4. ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ù…Ù‡Ø§Ù… Ù…Ù† Ù‚Ø§Ù„Ø¨ JSON
        <br>5. Ø¸Ù‡ÙˆØ± Ø§Ù„Ù…Ù‡Ø§Ù… ÙÙŠ Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©
    </div>

    <div class="mermaid">
        sequenceDiagram
        participant HR as HR Admin | Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©
        participant DB as Database | Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        participant T as Trigger | Ø§Ù„Ù…Ø´ØºÙ„
        participant OP as Onboarding | Ø§Ù„ØªÙ‡ÙŠØ¦Ø©
        HR->>DB: INSERT user_departments
        DB->>T: on_department_assigned
        T->>DB: Find onboarding_template
        T->>OP: CREATE onboarding_process
        T->>OP: Generate tasks from template
        OP->>HR: Tasks appear in dashboard | Ø¸Ù‡ÙˆØ± Ø§Ù„Ù…Ù‡Ø§Ù…
    </div>

    <hr class="page-break">

    <h2 class="bilingual-header">ğŸ”„ Promotion/Transfer Lifecycle <span class="ar-title">Ø¯ÙˆØ±Ø© Ø­ÙŠØ§Ø© Ø§Ù„ØªØ±Ù‚ÙŠØ©/Ø§Ù„Ù†Ù‚Ù„</span>
    </h2>

    <div class="ar">
        Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ±Ù‚ÙŠØ© Ø£Ùˆ Ø§Ù„Ù†Ù‚Ù„ ØªÙ…Ø± Ø¨Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©:
        <br>1. Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø´Ø±ÙŠØ© Ø§Ù„ÙÙ†Ø¯Ù‚ ØªØ³ØªØ¯Ø¹ÙŠ Ø¯Ø§Ù„Ø© ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø·Ù„Ø¨
        <br>2. Ø¥Ù†Ø´Ø§Ø¡ Ø³Ø¬Ù„ ØªØ±Ù‚ÙŠØ©/Ù†Ù‚Ù„ Ø¨Ø­Ø§Ù„Ø© "Ù…Ø¹Ù„Ù‚"
        <br>3. Ø¥Ù†Ø´Ø§Ø¡ Ø·Ù„Ø¨ ÙÙŠ Ø¬Ø¯ÙˆÙ„ requests
        <br>4. Ø§Ù„Ø·Ù„Ø¨ ÙŠÙ…Ø± Ø¨Ø³ÙŠØ± Ø¹Ù…Ù„ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©
        <br>5. Ø¹Ù†Ø¯ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©ØŒ Ø§Ù„Ù…Ø´ØºÙ„ ÙŠØ­Ø¯Ø« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù
        <br>6. Ø¥Ø°Ø§ ÙƒØ§Ù† ØªØ§Ø±ÙŠØ® Ø§Ù„Ø³Ø±ÙŠØ§Ù† Ø§Ù„ÙŠÙˆÙ… Ø£Ùˆ Ù‚Ø¨Ù„Ù‡ØŒ ÙŠØªÙ… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙÙˆØ±Ø§Ù‹
    </div>

    <div class="mermaid">
        sequenceDiagram
        participant HR as Property HR | Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø´Ø±ÙŠØ© Ø§Ù„ÙÙ†Ø¯Ù‚
        participant RPC as submit_promotion_request
        participant R as requests | Ø§Ù„Ø·Ù„Ø¨Ø§Øª
        participant P as promotions | Ø§Ù„ØªØ±Ù‚ÙŠØ§Øª
        participant TR as Trigger | Ø§Ù„Ù…Ø´ØºÙ„
        HR->>RPC: Call with employee details
        RPC->>P: INSERT promotion pending
        RPC->>R: INSERT request
        R-->>HR: Returns request_no
        Note over R: Approval workflow | Ø³ÙŠØ± Ø¹Ù…Ù„ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©
        R->>TR: status = approved
        TR->>P: promotions approved
        TR->>TR: process_due_promotions
        alt effective_date <= TODAY | ØªØ§Ø±ÙŠØ® Ø§Ù„Ø³Ø±ÙŠØ§Ù† Ø§Ù„ÙŠÙˆÙ… Ø£Ùˆ Ù‚Ø¨Ù„Ù‡ TR->>DB: UPDATE user_roles
            TR->>DB: UPDATE profiles job_title
            TR->>P: status = completed
            end
    </div>

    <hr>

    <h2 class="bilingual-header">ğŸ—‚ï¸ Full Module Integration Map <span class="ar-title">Ø®Ø±ÙŠØ·Ø© ØªÙƒØ§Ù…Ù„ Ø§Ù„ÙˆØ­Ø¯Ø§Øª
            Ø§Ù„ÙƒØ§Ù…Ù„Ø©</span></h2>

    <div class="mermaid">
        mindmap
        root((PRIME Hotels Intranet<br>Ø´Ø¨ÙƒØ© ÙÙ†Ø§Ø¯Ù‚ Ø¨Ø±Ø§ÙŠÙ… Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©))
        Core Identity<br>Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
        profiles<br>Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©
        user_roles<br>Ø£Ø¯ÙˆØ§Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
        user_properties<br>ÙÙ†Ø§Ø¯Ù‚ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
        user_departments<br>Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
        HR Management<br>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©
        leave_requests<br>Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©
        promotions<br>Ø§Ù„ØªØ±Ù‚ÙŠØ§Øª
        transfers<br>Ø§Ù„ØªÙ†Ù‚Ù„Ø§Øª
        onboarding<br>Ø§Ù„ØªÙ‡ÙŠØ¦Ø©
        Training<br>Ø§Ù„ØªØ¯Ø±ÙŠØ¨
        training_modules<br>ÙˆØ­Ø¯Ø§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨
        training_assignments<br>ØªØ¹ÙŠÙŠÙ†Ø§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨
        training_progress<br>ØªÙ‚Ø¯Ù… Ø§Ù„ØªØ¯Ø±ÙŠØ¨
        certificates<br>Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª
        Documents<br>Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª
        documents<br>Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª
        versions<br>Ø§Ù„Ø¥ØµØ¯Ø§Ø±Ø§Øª
        acknowledgments<br>Ø§Ù„Ø¥Ù‚Ø±Ø§Ø±Ø§Øª
        SOPs<br>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªØ´ØºÙŠÙ„
        Operations<br>Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª
        tasks<br>Ø§Ù„Ù…Ù‡Ø§Ù…
        maintenance<br>Ø§Ù„ØµÙŠØ§Ù†Ø©
        Communication<br>Ø§Ù„ØªÙˆØ§ØµÙ„
        messages<br>Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
        announcements<br>Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
        notifications<br>Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
        Workflow<br>Ø³ÙŠØ± Ø§Ù„Ø¹Ù…Ù„
        requests<br>Ø§Ù„Ø·Ù„Ø¨Ø§Øª
        request_steps<br>Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø·Ù„Ø¨
        escalation<br>Ø§Ù„ØªØµØ¹ÙŠØ¯
        Admin<br>Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
        audit_logs<br>Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©
        pii_access<br>ÙˆØµÙˆÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©
    </div>

    <hr>

    <h2 class="bilingual-header">ğŸ“Š Data Flow Summary <span class="ar-title">Ù…Ù„Ø®Øµ ØªØ¯ÙÙ‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</span></h2>

    <table>
        <tr>
            <th>Action | Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡</th>
            <th>Trigger | Ø§Ù„Ù…Ø´ØºÙ„</th>
            <th>Tables Affected | Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ù…ØªØ£Ø«Ø±Ø©</th>
            <th>Notifications | Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</th>
        </tr>
        <tr>
            <td><strong>New Employee</strong><br>Ù…ÙˆØ¸Ù Ø¬Ø¯ÙŠØ¯</td>
            <td>INSERT user_departments</td>
            <td>onboarding_process, tasks</td>
            <td>Manager | Ø§Ù„Ù…Ø¯ÙŠØ±</td>
        </tr>
        <tr>
            <td><strong>Submit Leave</strong><br>ØªÙ‚Ø¯ÙŠÙ… Ø¥Ø¬Ø§Ø²Ø©</td>
            <td>RPC call</td>
            <td>leave_requests, requests</td>
            <td>Supervisor | Ø§Ù„Ù…Ø´Ø±Ù</td>
        </tr>
        <tr>
            <td><strong>Approve Leave</strong><br>Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©</td>
            <td>request_apply_action</td>
            <td>requests, events</td>
            <td>Requester | Ù…Ù‚Ø¯Ù… Ø§Ù„Ø·Ù„Ø¨</td>
        </tr>
        <tr>
            <td><strong>Assign Training</strong><br>ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªØ¯Ø±ÙŠØ¨</td>
            <td>INSERT</td>
            <td>assignments, progress</td>
            <td>User | Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</td>
        </tr>
        <tr>
            <td><strong>Complete Training</strong><br>Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„ØªØ¯Ø±ÙŠØ¨</td>
            <td>UPDATE</td>
            <td>progress, certificates</td>
            <td>Manager | Ø§Ù„Ù…Ø¯ÙŠØ±</td>
        </tr>
        <tr>
            <td><strong>Submit Promotion</strong><br>ØªÙ‚Ø¯ÙŠÙ… ØªØ±Ù‚ÙŠØ©</td>
            <td>RPC</td>
            <td>promotions, requests</td>
            <td>Regional HR | Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø´Ø±ÙŠØ© Ø¥Ù‚Ù„ÙŠÙ…ÙŠØ©</td>
        </tr>
    </table>

    <hr>

    <h2 class="bilingual-header">ğŸ”’ Row-Level Security (RLS) Patterns <span class="ar-title">Ø£Ù†Ù…Ø§Ø· Ø£Ù…Ø§Ù† Ù…Ø³ØªÙˆÙ‰
            Ø§Ù„ØµÙ</span></h2>

    <div class="ar">
        ÙŠØ³ØªØ®Ø¯Ù… Ø§Ù„Ù†Ø¸Ø§Ù… Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ÙˆØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:
    </div>

    <table>
        <tr>
            <th>Function | Ø§Ù„Ø¯Ø§Ù„Ø©</th>
            <th>Purpose | Ø§Ù„ØºØ±Ø¶</th>
        </tr>
        <tr>
            <td><code>has_role(user_id, role)</code></td>
            <td>Check if user has specific role | Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¯ÙˆØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</td>
        </tr>
        <tr>
            <td><code>has_property_access(user_id, property_id)</code></td>
            <td>Check user_properties membership | Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¶ÙˆÙŠØ© Ø§Ù„ÙÙ†Ø¯Ù‚</td>
        </tr>
        <tr>
            <td><code>can_view_request(user_id, request_id)</code></td>
            <td>Complex request visibility | Ø±Ø¤ÙŠØ© Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ù…Ø¹Ù‚Ø¯Ø©</td>
        </tr>
        <tr>
            <td><code>is_hr(user_id)</code></td>
            <td>Check if user is any HR role | Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¯ÙˆØ± HR</td>
        </tr>
        <tr>
            <td><code>is_admin(user_id)</code></td>
            <td>Check if regional_admin | Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ø¥Ù‚Ù„ÙŠÙ…ÙŠ</td>
        </tr>
    </table>

    <hr>

    <h2 class="bilingual-header">Summary <span class="ar-title">Ø§Ù„Ù…Ù„Ø®Øµ</span></h2>

    <p>The PRIME Hotels Intranet is a <strong>multi-tenant, role-based, property-scoped</strong> system where:</p>

    <ol>
        <li><strong>Identity</strong>: Users have profiles + multiple roles + property/department assignments</li>
        <li><strong>Authorization</strong>: Computed from primaryRole (highest authority) + property/dept scope</li>
        <li><strong>Workflows</strong>: Generic requests table powers all approval flows</li>
        <li><strong>Targeting</strong>: Training/docs/announcements target users, departments, properties, or roles</li>
        <li><strong>Automation</strong>: Database triggers auto-create onboarding, finalize promotions</li>
        <li><strong>Security</strong>: PostgreSQL RLS enforces access at database level</li>
    </ol>

    <div class="ar">
        <strong>Ø´Ø¨ÙƒØ© ÙÙ†Ø§Ø¯Ù‚ Ø¨Ø±Ø§ÙŠÙ… Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©</strong> Ù‡ÙŠ Ù†Ø¸Ø§Ù… <strong>Ù…ØªØ¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±ÙŠÙ†ØŒ Ù‚Ø§Ø¦Ù… Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¯ÙˆØ§Ø±ØŒ Ù…Ø­Ø¯Ø¯ Ø§Ù„Ù†Ø·Ø§Ù‚
            Ø¨Ø§Ù„ÙÙ†Ø¯Ù‚</strong> Ø­ÙŠØ«:
        <br><br>
        1. <strong>Ø§Ù„Ù‡ÙˆÙŠØ©</strong>: Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ù„Ø¯ÙŠÙ‡Ù… Ù…Ù„ÙØ§Øª Ø´Ø®ØµÙŠØ© + Ø£Ø¯ÙˆØ§Ø± Ù…ØªØ¹Ø¯Ø¯Ø© + ØªØ¹ÙŠÙŠÙ†Ø§Øª ÙÙ†Ø¯Ù‚/Ù‚Ø³Ù…
        <br>2. <strong>Ø§Ù„ØªÙÙˆÙŠØ¶</strong>: Ù…Ø­Ø³ÙˆØ¨ Ù…Ù† Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ (Ø£Ø¹Ù„Ù‰ ØµÙ„Ø§Ø­ÙŠØ©) + Ù†Ø·Ø§Ù‚ Ø§Ù„ÙÙ†Ø¯Ù‚/Ø§Ù„Ù‚Ø³Ù…
        <br>3. <strong>Ø³ÙŠØ± Ø§Ù„Ø¹Ù…Ù„</strong>: Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¹Ø§Ù… ÙŠØ¯Ø¹Ù… Ø¬Ù…ÙŠØ¹ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©
        <br>4. <strong>Ø§Ù„Ø§Ø³ØªÙ‡Ø¯Ø§Ù</strong>: Ø§Ù„ØªØ¯Ø±ÙŠØ¨/Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª/Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ØªØ³ØªÙ‡Ø¯Ù Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø£Ùˆ Ø£Ù‚Ø³Ø§Ù… Ø£Ùˆ ÙÙ†Ø§Ø¯Ù‚ Ø£Ùˆ Ø£Ø¯ÙˆØ§Ø±
        <br>5. <strong>Ø§Ù„Ø£ØªÙ…ØªØ©</strong>: Ù…Ø´ØºÙ„Ø§Øª Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙ†Ø´Ø¦ Ø§Ù„ØªÙ‡ÙŠØ¦Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙˆØªÙ†Ù‡ÙŠ Ø§Ù„ØªØ±Ù‚ÙŠØ§Øª
        <br>6. <strong>Ø§Ù„Ø£Ù…Ø§Ù†</strong>: RLS ÙÙŠ PostgreSQL ÙŠÙØ±Ø¶ Ø§Ù„ÙˆØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    </div>

    <hr>
    <p style="text-align: center; color: #888; margin-top: 40px;">
        <em>Generated on December 20, 2025 â€¢ PRIME Hotels Intranet v1.0</em><br>
        <em style="font-family: 'Noto Sans Arabic', sans-serif;">ØªÙ… Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ ÙÙŠ 20 Ø¯ÙŠØ³Ù…Ø¨Ø± 2025 â€¢ Ø´Ø¨ÙƒØ© ÙÙ†Ø§Ø¯Ù‚ Ø¨Ø±Ø§ÙŠÙ…
            Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ© Ø§Ù„Ø¥ØµØ¯Ø§Ø± 1.0</em>
    </p>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'neutral',
            securityLevel: 'loose',
            flowchart: { useMaxWidth: true, htmlLabels: true },
            sequence: { useMaxWidth: true }
        });
    </script>
</body>

</html>